[alias]
  tree  = log --graph --abbrev-commit --decorate=no --date=format:'%Y-%m-%d %H:%I' --format=format:'%C(yellow)%>|(20)%h%C(reset)  %C(blue)%ad%C(reset) %C(dim green)(%ar)%>|(60)%C(reset)  %C(dim red)%<(16,trunc)%an%C(reset)  %C(dim green)%d%C(reset) %C(white)%>|(1)%s%C(reset)' --all

  # word diff
  wdiff = diff --word-diff --color-words --no-index

  # char diff
  cdiff = diff --color-words=. --no-index

  # find commit by case insensitive content of commits (without and with body)
  find  = "!f() { git log    --no-merges -i -S\"$*\"; }; f"
  ffind = "!f() { git log -c --no-merges -i -S\"$*\"; }; f"

  # create commit without changes (to start with a defined commit message)
  empty = commit --allow-empty

  # ai generated commit message
  ai-commit = "!f() { \
    if git diff --cached --quiet; then \
      git diff --quiet && echo 'No changes to commit' && exit 1; \
      echo 'No staged changes, staging all modified files...'; \
      git add -A; \
    fi; \
    \
    RECENT_COMMITS=$(git log -5 --pretty=format:'- %s' 2>/dev/null || echo 'No commit history'); \
    echo 'Generating commit message, this can take a bit...'; \
    git diff --cached | head -n 500 | \
    opencode \
      --model "github-copilot/claude-sonnet-4.5" \
      run "\
        Analyze the recent commit message patterns and write a commit message that matches the style and format.\
        Only return the commit message itself with no explanation or formatting.\
        Recent commits: $RECENT_COMMITS. Diff:\
      " \
      > /tmp/AI_COMMIT_MSG && \
    \
    echo '' >> /tmp/AI_COMMIT_MSG && \
    echo '# Delete all lines above to abort AI commit' >> /tmp/AI_COMMIT_MSG && \
    \
    git commit --edit --file=/tmp/AI_COMMIT_MSG; \
    rm /tmp/AI_COMMIT_MSG; \
  }; f"

  # ai rewrite last commit message
  ai-rewrite = "!f() { \
    if ! git rev-parse HEAD >/dev/null 2>&1; then \
      echo 'No commits to rewrite' && exit 1; \
    fi; \
    \
    RECENT_COMMITS=$(git log -6 --skip=1 --pretty=format:'- %s' 2>/dev/null || echo 'No commit history'); \
    echo 'Generating new commit message, this can take a bit...'; \
    git show HEAD | head -n 500 | \
    opencode \
      --model "github-copilot/claude-sonnet-4.5" \
      run "\
        Analyze the recent commit message patterns and write a commit message that matches the style and format.\
        Only return the commit message itself with no explanation or formatting.\
        Recent commits: $RECENT_COMMITS. Diff:\
      " \
      > /tmp/AI_COMMIT_MSG && \
    \
    echo '' >> /tmp/AI_COMMIT_MSG && \
    echo '# Delete all lines above to abort AI commit rewrite' >> /tmp/AI_COMMIT_MSG && \
    \
    git commit --amend --edit --file=/tmp/AI_COMMIT_MSG; \
    rm /tmp/AI_COMMIT_MSG; \
  }; f"

# vim:filetype=gitconfig
